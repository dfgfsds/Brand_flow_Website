(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[742],{6316:function(e,t,s){"use strict";s.d(t,{Z:function(){return a}});let a=(0,s(1373).Z)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},4923:function(e,t,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/forgot-password",function(){return s(2904)}])},2904:function(e,t,s){"use strict";s.r(t),s.d(t,{default:function(){return m}});var a=s(5893),r=s(1869),l=s(8031),n=s(6953),o=s(6316),i=s(1607),d=s(4464),c=s(9332),u=s(7294);function m(){let[e,t]=(0,u.useState)(""),[s,m]=(0,u.useState)(!1),[x,f]=(0,u.useState)(Array(6).fill("")),[v,h]=(0,u.useState)(60),[p,g]=(0,u.useState)(!1),[b,y]=(0,u.useState)(""),[j,w]=(0,u.useState)(""),N=(0,u.useRef)([]),[S,_]=(0,u.useState)(""),[k,P]=(0,u.useState)(null),C=(0,c.useRouter)(),[T,E]=(0,u.useState)(""),[Z,O]=(0,u.useState)(!1),[I,R]=(0,u.useState)(""),[F,Y]=(0,u.useState)(!1),[q,A]=(0,u.useState)(!1),[D,z]=(0,u.useState)(!1),[L,W]=(0,u.useState)(!1),{vendorId:X}=(0,l.a)();(0,u.useEffect)(()=>{P(localStorage.getItem("forgetuserId"))},[]),(0,u.useEffect)(()=>{if(s&&v>0){let e=setInterval(()=>h(e=>e-1),1e3);return()=>clearInterval(e)}},[s,v]);let B=async t=>{t.preventDefault(),E(""),O(!0);try{var s,a,l;let t=await (0,r.hY)("?email=".concat(e,"&vendor_id=").concat(X));if(null==t?void 0:null===(s=t.data)||void 0===s?void 0:s.id){let e=await (0,r.a6)({email:null==t?void 0:null===(a=t.data)||void 0===a?void 0:a.email,vendor_id:X});e&&(O(!1),_(null==e?void 0:null===(l=e.data)||void 0===l?void 0:l.token),m(!0),h(60),f(Array(6).fill("")),setTimeout(()=>{var e;return null===(e=N.current[0])||void 0===e?void 0:e.focus()},100))}else E("You're not a user, please create an account."),O(!1)}catch(e){E("You're not a user, please create an account."),O(!1)}},K=(e,t)=>{var s;if(!/^\d*$/.test(e))return;let a=[...x];a[t]=e,f(a),e&&t<5&&(null===(s=N.current[t+1])||void 0===s||s.focus())},M=(e,t)=>{if("Backspace"===e.key&&!x[t]&&t>0){var s;null===(s=N.current[t-1])||void 0===s||s.focus()}},V=async()=>{Y(!0),R("");let e=x.join("");if(6===e.length){var t,s,a,l;try{let a=await (0,r.fW)({token:S,otp:e,vendor_id:X,login_type:"user"});(null==a?void 0:null===(t=a.data)||void 0===t?void 0:t.user_id)&&(localStorage.setItem("forgetuserId",null==a?void 0:null===(s=a.data)||void 0===s?void 0:s.user_id),Y(!1),m(!1),g(!0))}catch(e){R((null==e?void 0:null===(l=e.response)||void 0===l?void 0:null===(a=l.data)||void 0===a?void 0:a.message)||"Failed to verify OTP. Please try again."),Y(!1)}}else Y(!1),R("Please enter a valid 6-digit OTP.")},$=async e=>{if(e.preventDefault(),b!==j){alert("Passwords do not match.");return}W(!0);try{await (0,r.L)("/".concat(k),{password:b,updated_by:"user",role:3,vendor:X})&&(C.push("/login"),g(!1),t(""),y(""),w(""))}catch(e){console.error("Password reset failed:",e)}finally{W(!1)}},G=async()=>{E("");try{var t,s,a;let l=await (0,r.hY)("?email=".concat(e,"&vendor_id=").concat(X));if(null==l?void 0:null===(t=l.data)||void 0===t?void 0:t.id){let e=await (0,r.a6)({email:null==l?void 0:null===(s=l.data)||void 0===s?void 0:s.email,vendor_id:X});e&&(_(null==e?void 0:null===(a=e.data)||void 0===a?void 0:a.token),m(!0),h(60),f(Array(6).fill("")),setTimeout(()=>{var e;return null===(e=N.current[0])||void 0===e?void 0:e.focus()},100))}else E("You're not a registered user. Please create an account.")}catch(e){console.log(e,"check email error"),E("Failed to send OTP. Please try again.")}};return(0,a.jsxs)("div",{className:"min-h-screen bg-gray-50 flex flex-col pt-6 pb-12 sm:px-6 lg:px-8 p-2",children:[(0,a.jsxs)("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[(0,a.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Reset your password"}),(0,a.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Enter your email address and we'll send you instructions to reset your password."})]}),(0,a.jsx)("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:(0,a.jsx)("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:(0,a.jsxs)("div",{children:[!p&&(0,a.jsxs)("form",{onSubmit:B,className:"space-y-5",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email address"}),(0,a.jsxs)("div",{className:"mt-1 relative",children:[(0,a.jsx)(n.Z,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),(0,a.jsx)("input",{id:"email",type:"email",required:!0,value:e,onChange:e=>{t(e.target.value),T&&E("")},disabled:Z,className:"pl-10 p-2 block w-full rounded-md border ".concat(T?"border-red-500":"border-gray-300"," shadow-sm focus:border-blue-500 focus:ring-blue-500 ").concat(Z?"cursor-not-allowed bg-gray-100":"")})]})]}),T&&(0,a.jsx)("p",{className:"text-sm text-red-600 mt-2",children:T}),(0,a.jsxs)("button",{type:"submit",className:"w-full gap-2 flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-900 hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",disabled:Z,children:["Send OTP ",Z?(0,a.jsx)(o.Z,{className:"animate-spin"}):""]})]}),s&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,a.jsxs)("div",{className:"bg-white w-full max-w-md p-6 rounded shadow-lg relative",children:[(0,a.jsx)("h2",{className:"text-lg font-bold text-center mb-2",children:"Enter OTP"}),(0,a.jsxs)("p",{className:"text-sm text-gray-600 text-center mb-4",children:["We sent a 6-digit OTP to ",(0,a.jsx)("strong",{children:e})]}),(0,a.jsx)("div",{className:"flex justify-center gap-2 mb-4",children:x.map((e,t)=>(0,a.jsx)("input",{type:"text",maxLength:1,value:e,ref:e=>{e&&(N.current[t]=e)},onChange:e=>K(e.target.value,t),onKeyDown:e=>M(e,t),className:"w-10 h-12 text-center border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"},t))}),(0,a.jsx)("div",{className:"text-center text-sm text-gray-500 mb-4 cursor-pointer",children:0===v?(0,a.jsx)(a.Fragment,{children:(0,a.jsx)("span",{className:"cursor-pointer text-yellow-500 font-bold",onClick:G,children:"Resend"})}):(0,a.jsxs)(a.Fragment,{children:["Resend: ",(0,a.jsxs)("span",{className:"font-semibold cursor-pointer",children:[v," s"]})]})}),I&&(0,a.jsx)("p",{className:"text-sm text-red-600 text-center mb-4",children:I}),(0,a.jsx)("div",{className:"flex justify-between",children:(0,a.jsx)("button",{onClick:V,className:"w-full cursor-pointer  bg-blue-900 text-white py-2 rounded hover:bg-blue-900",disabled:F,children:(0,a.jsxs)("div",{className:"flex gap-2 justify-center",children:["Verify OTP   ",F?(0,a.jsx)(o.Z,{className:"animate-spin"}):""]})})}),(0,a.jsx)("button",{onClick:()=>m(!1),className:"absolute top-2 right-3 text-gray-500 hover:text-gray-700",children:"\xd7"})]})}),p&&(0,a.jsxs)("form",{onSubmit:$,className:"space-y-5 mt-6",children:[(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"New Password"}),(0,a.jsx)("input",{type:q?"text":"password",required:!0,value:b,onChange:e=>y(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500"}),(0,a.jsx)("span",{onClick:()=>A(e=>!e),className:"absolute top-8 right-3 text-gray-500 cursor-pointer",children:q?(0,a.jsx)(i.Z,{className:""}):(0,a.jsx)(d.Z,{})})]}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),(0,a.jsx)("input",{type:D?"text":"password",required:!0,value:j,onChange:e=>w(e.target.value),className:"w-full px-4 py-2 border rounded-md focus:ring-2 focus:ring-blue-500 ".concat((null==j?void 0:j.length)&&b!==j?"border-red-500":"border-gray-300")}),(0,a.jsx)("span",{onClick:()=>z(e=>!e),className:"absolute top-8 right-3 text-gray-500 cursor-pointer",children:D?(0,a.jsx)(i.Z,{}):(0,a.jsx)(d.Z,{})})]}),j&&b!==j&&(0,a.jsx)("p",{className:"text-sm text-red-600 text-center mb-4",children:"Passwords do not match. Please enter matching passwords."}),(0,a.jsx)("button",{type:"submit",className:"w-full bg-blue-900 text-white py-2 rounded-md hover:bg-blue-900 disabled:cursor-not-allowed",disabled:L,children:(0,a.jsxs)("div",{className:"flex gap-2 justify-center items-center",children:["Reset Password ",L&&(0,a.jsx)(o.Z,{className:"animate-spin"})]})})]})]})})})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=4923)}),_N_E=e.O()}]);