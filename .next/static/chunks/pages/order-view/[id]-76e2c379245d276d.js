(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[837],{3219:function(e,l,s){"use strict";s.d(l,{Z:function(){return d}});let d=(0,s(1373).Z)("arrow-left",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},1751:function(e,l,s){(window.__NEXT_P=window.__NEXT_P||[]).push(["/order-view/[id]",function(){return s(6716)}])},6716:function(e,l,s){"use strict";s.r(l);var d=s(5893),a=s(202),t=s(3934),i=s(3219),o=s(1352),n=s(9332),r=s(5314),c=s(8031),u=s(7294),v=s(7583),m=s(8405),x=s(5675),h=s.n(x),p=s(7066),g=s(9463),b=s(7151);l.default=function(){var e,l,s,x,f,j,N,w,y,_,C,k,S,D,R,O,F,L,E,I,U,P,A,M,z,Z,q,T,B,K,Q,V,W,X,Y,G,H,J,$,ee;let el=(0,n.useParams)(),es=null==el?void 0:el.id,{convertPrice:ed}=(0,m.U)(),ea=(0,a.NL)(),et=(0,n.useRouter)(),[ei,eo]=(0,u.useState)(null),{vendorId:en}=(0,c.a)(),[er,ec]=(0,u.useState)(!1),[eu,ev]=(0,u.useState)(0),[em,ex]=(0,u.useState)(0),[eh,ep]=(0,u.useState)(""),[eg,eb]=(0,u.useState)([]),[ef,ej]=(0,u.useState)([]),[eN,ew]=(0,u.useState)(null),[ey,e_]=(0,u.useState)([]),[eC,ek]=(0,u.useState)([]),[eS,eD]=(0,u.useState)(!1),eR=(0,u.useRef)(null),eO=(0,u.useRef)(null),[eF,eL]=(0,u.useState)([]),[eE,eI]=(0,u.useState)([]),eU=(e,l)=>{ev(l?e-.5:e)},eP=(e,l)=>{ex(l?e-.5:e)},eA=()=>{ex(0)},{ReviewItem:eM}=(0,b.J)();console.log(null==eM?void 0:null===(e=eM.data)||void 0===e?void 0:e.reviews," ReviewItem"),(0,u.useEffect)(()=>{eo(localStorage.getItem("userId"))},[]);let{data:ez}=(0,t.a)({queryKey:["getOrderSingle",en],queryFn:()=>(0,r.O9)("?user_id=".concat(Number(localStorage.getItem("userId")||ei),"&vendor_id=").concat(en,"&order_id=").concat(es))}),eZ=async()=>{if(!eN)return;eD(!0);let e=new FormData;e.append("product_id",String(eN)),e.append("user",String(ei)),e.append("vendor",String(en)),e.append("created_by",String(ei)),e.append("rating",String(eu)),e.append("comment",eh),eg.forEach(l=>{e.append("image_files",l)}),ef.forEach(l=>{e.append("video_files",l)});try{await p.Z.post("".concat(g.F,"/reviews/"),e,{headers:{"Content-Type":"multipart/form-data"}}),ea.invalidateQueries({queryKey:["getReviewData",ei]}),ew(null),ev(0),ep(""),eb([]),ej([]),ec(!1),eR.current&&(eR.current.value=""),eO.current&&(eO.current.value="")}catch(e){console.error("Review submission failed:",e)}finally{eD(!1)}};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsxs)("div",{className:"container mx-auto px-4 max-w-7xl mt-10",children:[(0,d.jsxs)("button",{onClick:()=>{et.back()},className:"cursor-pointer pl-5 flex items-center text-lg font-bold gap-2 text-gray-600 hover:text-gray-900 ",children:[(0,d.jsx)(i.Z,{className:"h-5 w-5"}),"Back"]}),(0,d.jsxs)("div",{className:"bg-white rounded-xl shadow-lg p-5 space-y-10",children:[(0,d.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-3 gap-8 text-sm text-gray-700",children:[(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsx)("h3",{className:"text-lg font-bold mb-1 text-gray-800",children:"Order Details"}),(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{className:"font-semibold",children:"Order ID:"})," #",null==ez?void 0:null===(l=ez.data)||void 0===l?void 0:l.id]}),(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{className:"font-semibold",children:"Order Date:"})," ",(0,v.p6)(null==ez?void 0:null===(s=ez.data)||void 0===s?void 0:s.created_at)]}),(0,d.jsxs)("p",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"font-semibold",children:"Status:"}),(0,d.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-md font-bold ".concat((null==ez?void 0:null===(x=ez.data)||void 0===x?void 0:x.status)==="Delivered"?"bg-green-100 text-green-800":(null==ez?void 0:null===(f=ez.data)||void 0===f?void 0:f.status)==="Pending"?"bg-yellow-100 text-yellow-800":(null==ez?void 0:null===(j=ez.data)||void 0===j?void 0:j.status)==="Processing"?"bg-blue-50 text-blue-700":(null==ez?void 0:null===(N=ez.data)||void 0===N?void 0:N.status)==="Shipped"?"bg-indigo-50 text-indigo-700":(null==ez?void 0:null===(w=ez.data)||void 0===w?void 0:w.status)==="Cancelled"?"bg-red-50 text-red-700":(null==ez?void 0:null===(y=ez.data)||void 0===y?void 0:y.status)==="Delivered"?"bg-green-100 text-green-700":"bg-red-100 text-yellow-500"),children:null==ez?void 0:null===(_=ez.data)||void 0===_?void 0:_.status})]})]}),(0,d.jsxs)("div",{className:"space-y-3",children:[(0,d.jsx)("h3",{className:"text-lg font-bold mb-1 text-gray-800",children:"Order Amount"}),parseFloat(null==ez?void 0:null===(C=ez.data)||void 0===C?void 0:C.total_amount)>0&&(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{className:"font-semibold",children:"Total Amount:"})," ",ed(Number(null==ez?void 0:null===(k=ez.data)||void 0===k?void 0:k.total_amount))]}),parseFloat(null==ez?void 0:null===(S=ez.data)||void 0===S?void 0:S.discount)>0&&(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{className:"font-semibold",children:"Discount:"})," ",ed(Number(null==ez?void 0:null===(D=ez.data)||void 0===D?void 0:D.discount))]}),parseFloat(null==ez?void 0:null===(R=ez.data)||void 0===R?void 0:R.delivery_charge)>0&&(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{className:"font-semibold",children:"Delivery Charge:"})," ",ed(Number(null==ez?void 0:null===(O=ez.data)||void 0===O?void 0:O.delivery_charge))]}),parseFloat(null==ez?void 0:null===(F=ez.data)||void 0===F?void 0:F.cod_charges)>0&&(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{className:"font-semibold",children:"COD Charges:"})," ",ed(Number(null==ez?void 0:null===(L=ez.data)||void 0===L?void 0:L.cod_charges))]}),parseFloat(null==ez?void 0:null===(E=ez.data)||void 0===E?void 0:E.delivery_discount)>0&&(0,d.jsxs)("p",{children:[(0,d.jsx)("span",{className:"font-semibold",children:"Delivery Discount:"})," ",ed(Number(null==ez?void 0:null===(I=ez.data)||void 0===I?void 0:I.delivery_discount))]}),(0,d.jsxs)("p",{className:"flex items-center gap-2",children:[(0,d.jsx)("span",{className:"font-semibold",children:"Payment Status:"}),(0,d.jsx)("span",{className:"bg-green-100 text-green-800 text-xs font-semibold px-3 py-1 rounded-full shadow-sm uppercase",children:null==ez?void 0:null===(U=ez.data)||void 0===U?void 0:U.payment_status})]})]}),(0,d.jsxs)("div",{className:"text-sm",children:[(0,d.jsx)("h3",{className:"text-lg font-bold mb-1 text-gray-800",children:"Shipping Address"}),(0,d.jsxs)("p",{className:"text-gray-600 leading-6",children:[null==ez?void 0:null===(M=ez.data)||void 0===M?void 0:null===(A=M.consumer_address)||void 0===A?void 0:null===(P=A.address_type)||void 0===P?void 0:P.toUpperCase(),", ",null==ez?void 0:null===(Z=ez.data)||void 0===Z?void 0:null===(z=Z.consumer_address)||void 0===z?void 0:z.address_line1,", ",null==ez?void 0:null===(T=ez.data)||void 0===T?void 0:null===(q=T.consumer_address)||void 0===q?void 0:q.address_line2,",",(0,d.jsx)("br",{}),null==ez?void 0:null===(K=ez.data)||void 0===K?void 0:null===(B=K.consumer_address)||void 0===B?void 0:B.city,", ",null==ez?void 0:null===(V=ez.data)||void 0===V?void 0:null===(Q=V.consumer_address)||void 0===Q?void 0:Q.state," - ",null==ez?void 0:null===(X=ez.data)||void 0===X?void 0:null===(W=X.consumer_address)||void 0===W?void 0:W.postal_code,",",(0,d.jsx)("br",{}),null==ez?void 0:null===(G=ez.data)||void 0===G?void 0:null===(Y=G.consumer_address)||void 0===Y?void 0:Y.country,(0,d.jsx)("br",{}),(0,d.jsxs)("span",{className:"text-gray-500",children:["Landmark: ",null==ez?void 0:null===(J=ez.data)||void 0===J?void 0:null===(H=J.consumer_address)||void 0===H?void 0:H.landmark]})]})]})]}),(0,d.jsxs)("div",{children:[(0,d.jsx)("h3",{className:"text-xl font-bold text-gray-800 border-b pb-2 mb-4",children:"Items in Order"}),(0,d.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-2 gap-6",children:null==ez?void 0:null===(ee=ez.data)||void 0===ee?void 0:null===($=ee.order_items)||void 0===$?void 0:$.map(e=>{var l,s,a,t,i,o;let n=null==eM?void 0:null===(s=eM.data)||void 0===s?void 0:null===(l=s.reviews)||void 0===l?void 0:l.filter(l=>{var s;return l.product_id===(null==e?void 0:null===(s=e.product)||void 0===s?void 0:s.id)});return(0,d.jsxs)("div",{className:"mb-6",children:[(0,d.jsxs)("div",{className:"flex gap-4 bg-white border border-gray-200 p-4 rounded-xl shadow-md hover:shadow-lg transition-shadow",children:[(0,d.jsx)(h(),{src:null==e?void 0:null===(t=e.product)||void 0===t?void 0:null===(a=t.image_urls)||void 0===a?void 0:a[0],className:"h-24 w-24 object-cover rounded-lg border",alt:"product",width:100,height:100}),(0,d.jsx)("div",{className:"flex flex-col justify-between w-full",children:(0,d.jsxs)("div",{children:[(0,d.jsx)("h4",{onClick:()=>{var l;return et.push("/shop/".concat((null==e?void 0:null===(l=e.product)||void 0===l?void 0:l.name).toLowerCase().trim().replace(/\s+/g,"-").replace(/[^\w-]+/g,"")))},className:"text-lg font-semibold text-gray-900 mb-1",children:null==e?void 0:null===(i=e.product)||void 0===i?void 0:i.name}),(0,d.jsxs)("div",{className:"text-sm text-gray-600 space-y-1",children:[(0,d.jsxs)("p",{className:"font-bold",children:["Qty:"," ",(0,d.jsx)("span",{className:"text-gray-800 font-medium",children:null==e?void 0:e.quantity})]}),(0,d.jsxs)("p",{className:"font-bold",children:["Price:"," ",(0,d.jsx)("span",{className:"text-gray-800 font-medium",children:ed(Number(null==e?void 0:e.price))})]})]})]})})]}),(null==ez?void 0:null===(o=ez.data)||void 0===o?void 0:o.status)==="Delivered"&&((null==n?void 0:n.length)>0?(0,d.jsxs)("div",{className:"mt-4 space-y-3",children:[(0,d.jsx)("h5",{className:"font-semibold text-gray-800",children:"Your Review:"}),null==n?void 0:n.map(e=>{var l,s;return(0,d.jsxs)("div",{className:"border rounded-lg p-3 bg-gray-50 shadow-sm",children:[(0,d.jsxs)("p",{className:"text-yellow-500 font-bold",children:["â­ ",e.rating,"/5"]}),(0,d.jsx)("p",{className:"text-gray-700",children:e.comment}),(0,d.jsxs)("div",{className:"flex gap-3",children:[(null==e?void 0:null===(l=e.image_urls)||void 0===l?void 0:l.length)>0&&(0,d.jsx)("div",{className:"flex gap-2 mt-2",children:e.image_urls.map((e,l)=>(0,d.jsx)("img",{src:e,alt:"review",className:"w-16 h-16 object-cover rounded border"},l))}),(null==e?void 0:null===(s=e.video_urls)||void 0===s?void 0:s.length)>0&&(0,d.jsx)("div",{className:"flex gap-2 mt-2",children:e.video_urls.map((e,l)=>(0,d.jsx)("video",{src:e,controls:!0,className:"w-16 h-16 rounded border object-cover"},l))})]})]},e.id)})]}):(0,d.jsx)("div",{className:"mt-3 flex gap-3",children:(0,d.jsx)("button",{onClick:()=>{var l;ew(null==e?void 0:null===(l=e.product)||void 0===l?void 0:l.id),ec(!0)},className:"bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg shadow",children:"Rate & Review"})}))]},e.id)})})]})]})]}),er&&(0,d.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-40 flex items-center justify-center z-50",children:(0,d.jsxs)("div",{className:"bg-white rounded-xl shadow-lg w-full max-w-lg p-6 relative overflow-y-auto max-h-[80vh]",children:[(0,d.jsx)("button",{onClick:()=>ec(!1),className:"absolute top-3 right-3 text-gray-500 hover:text-gray-800",children:(0,d.jsx)(o.Z,{className:"w-6 h-6"})}),(0,d.jsx)("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Rate Your Review"}),(0,d.jsx)("div",{className:"flex space-x-1",children:[1,2,3,4,5].map(e=>(0,d.jsxs)("div",{className:"relative w-8 h-8 cursor-pointer",children:[(0,d.jsx)("div",{className:"absolute left-0 top-0 w-1/2 h-full z-10",onMouseEnter:()=>eP(e,!0),onMouseLeave:eA,onClick:()=>eU(e,!0)}),(0,d.jsx)("div",{className:"absolute right-0 top-0 w-1/2 h-full z-10",onMouseEnter:()=>eP(e,!1),onMouseLeave:eA,onClick:()=>eU(e,!1)}),(0,d.jsxs)("svg",{className:"w-8 h-8 text-yellow-400",fill:(em||eu)>=e?"currentColor":(em||eu)>=e-.5?"url(#half)":"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[(0,d.jsx)("defs",{children:(0,d.jsxs)("linearGradient",{id:"half",children:[(0,d.jsx)("stop",{offset:"50%",stopColor:"currentColor"}),(0,d.jsx)("stop",{offset:"50%",stopColor:"transparent"})]})}),(0,d.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11.049 2.927c.3-.921 1.603-.921 1.902 0l1.518 4.674a1   1 0 00.95.69h4.915c.969 0 1.371   1.24.588 1.81l-3.977 2.89a1 1   0 00-.364 1.118l1.518   4.674c.3.921-.755 1.688-1.54   1.118l-3.977-2.89a1 1   0 00-1.175 0l-3.977 2.89c-.784.57-1.838-.197-1.539-1.118l1.518-4.674a1   1 0 00-.364-1.118l-3.977-2.89c-.783-.57-.38-1.81.588-1.81h4.915a1   1 0 00.95-.69l1.518-4.674z"})]})]},e))}),(0,d.jsx)("textarea",{value:eh,onChange:e=>ep(e.target.value),placeholder:"Write your review...",className:"w-full border rounded-lg p-3 mb-4 focus:ring focus:ring-blue-300 mt-4"}),(0,d.jsxs)("div",{children:[(0,d.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Upload Images"}),(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=eR.current)||void 0===e?void 0:e.click()},className:"px-4 py-2 bg-blue-500 hover:bg-blue-600 text-white text-sm rounded-lg shadow flex items-center gap-2",children:"\uD83D\uDCF7 Choose Images"}),(0,d.jsx)("input",{ref:eR,type:"file",multiple:!0,accept:"image/*",onChange:e=>{if(e.target.files){let l=Array.from(e.target.files);eb(l),eL(l.map(e=>URL.createObjectURL(e)))}},className:"hidden"})]}),(0,d.jsx)("div",{className:"flex gap-2 flex-wrap mt-3",children:eF.map((e,l)=>(0,d.jsx)("img",{src:e,alt:"preview-".concat(l),className:"w-24 h-24 object-cover rounded-lg border shadow-sm"},l))})]}),(0,d.jsxs)("div",{className:"mt-4",children:[(0,d.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Upload Videos"}),(0,d.jsxs)("div",{className:"flex items-center gap-3",children:[(0,d.jsx)("button",{type:"button",onClick:()=>{var e;return null===(e=eO.current)||void 0===e?void 0:e.click()},className:"px-4 py-2 bg-green-500 hover:bg-green-600 text-white text-sm rounded-lg shadow flex items-center gap-2",children:"\uD83C\uDFA5 Choose Videos"}),(0,d.jsx)("input",{ref:eO,type:"file",multiple:!0,accept:"video/*",onChange:e=>{if(e.target.files){let l=Array.from(e.target.files);ej(l),eI(l.map(e=>URL.createObjectURL(e)))}},className:"hidden"})]}),(0,d.jsx)("div",{className:"flex gap-2 flex-wrap mt-3",children:eE.map((e,l)=>(0,d.jsx)("video",{src:e,controls:!0,className:"w-40 h-24 rounded-lg border shadow-sm"},l))})]}),(0,d.jsx)("button",{onClick:eZ,className:"w-full bg-blue-900 hover:bg-red-700 text-white font-semibold py-2 rounded-lg",children:"Submit Review"})]})})]})}}},function(e){e.O(0,[888,774,179],function(){return e(e.s=1751)}),_N_E=e.O()}]);